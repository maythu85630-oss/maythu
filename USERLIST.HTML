<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ADMIN PANEL</title>
<link rel="icon" href="https://i.postimg.cc/fLx8vKb4/5c934dcd65d48-Dollar-Sign-Cartoon-Vector-Character.png" type="image/png">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">

<style>
body {font-family: Arial, sans-serif; background:#f8faff; padding:20px;}

.page-btn {
  white-space: nowrap;
}

/* Action buttons */
.delete-btn {background:red;color:white; margin-left:30px;}
.disable-btn {background:orange;color:white;}
.turnon-btn {background:orange;color:white;}

/* Shutdown Button */
#shutdownToggle {
  padding: 6px 40px;       
  font-size: 16px;
  border-radius: 6px;
  background: #007bff;
  color: white;
  cursor: pointer;
  margin-left: 0px;       
  line-height: 20px;        
  white-space: nowrap;     
}

/* Search Button */
#userPage button[onclick="searchTable()"],
#exportBtn {
  padding: 8px 20px;      
  font-size: 14px;         
  border-radius: 6px;
  cursor: pointer;
  line-height: 18px;       
  white-space: nowrap;
}

.tooltip-box {
  display: none;
  position: absolute;
  top: 45px;
  left: calc(50% - 10px); 
  transform: translateX(-110%); 
  background: #ffffff;
  border: 1px solid #e0e0e0;
  padding: 6px 4px;
  border-radius: 10px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.12);
  z-index: 100;
}

/* Button basic style */
.tooltip-box button {
  font-size: 10px;          
  padding: 3px 3px;        
  margin: 2px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s ease;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

/* CHANGE button */
.btn-change {
  background: linear-gradient(135deg, #43e97b, #38f9d7);
  color: white;
}
.btn-change:hover {
  background: linear-gradient(135deg, #3bd06e, #2fdac3);
  transform: scale(1.05);
}


#logoutImg {
  margin-left: -60px;
}

.tooltip-box {
  left: 45%;
}

/* Buttons animation */
button {
  border:none;
  padding:5px 12px;
  border-radius:5px;
  cursor:pointer;
  background:#007bff;
  color:white;
  transition: transform 0.15s ease;
}
button:hover {opacity:0.85;}

/* Action buttons */
.delete-btn, .disable-btn, .edit-btn, .turnon-btn {
  padding:4px 8px;
  font-size:12px;
  min-width:60px;
  height:28px;
  border-radius:4px;
}
.delete-btn {background:red;color:white;}
.disable-btn, .turnon-btn {background:orange;color:white;}

/* Table styling */
table {border-collapse:collapse; width:100%; margin-bottom:20px; background:#e6f0ff;}
th, td {border:1px solid #99c2ff; padding:8px; text-align:left;}
th {background: linear-gradient(100deg,#bae1ff 0%,#d6e9ff 100%);}
input[type="text"], input[type="file"], input[type="email"], input[type="password"], select {width:90%; padding:5px; box-sizing:border-box;}

/* Image preview modal */
img.preview {width:50px; height:auto; cursor:pointer;}
#imgModal {display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); justify-content:center; align-items:center;}
#imgModal img {max-width:90%; max-height:90%; border:3px solid #fff; cursor:pointer;}

/* Toast */
.toast{position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); background:white; padding:25px; border-radius:12px; text-align:center; box-shadow:0 4px 15px rgba(0,0,0,0.2); display:none; z-index:3000;}
.toast .checkmark{width:60px; height:60px; border-radius:50%; border:3px solid #4caf50; display:flex; justify-content:center; align-items:center; margin:0 auto 10px;}
.toast .checkmark::after{content:"‚úî"; color:#4caf50; font-size:30px;}
.toast p{margin:0;font-size:16px; color:#333;}

/* Search input */
.search-input {width:250px; padding:5px 10px; font-size:16px; border:3px solid #99c2ff; border-radius:6px; margin-right:10px;}

/* SweetAlert2 */
.swal2-popup {background-color: white !important; width: 350px !important; font-size: 14px !important; padding: 20px !important; min-width: 60px !important;}
.swal2-confirm {background-color: #007bff !important; color: white !important; font-size: 14px !important; padding: 6px 14px !important; min-width: 70px !important; min-height: 30px !important; border-radius: 4px !important;}
.swal2-deny, .swal2-cancel {background-color: #dc3545 !important; color:white !important; font-size: 14px !important; padding: 6px 14px !important; min-width: 70px !important; min-height: 30px !important; border-radius: 4px !important;}
.swal-confirm-red {background-color:#e74c3c !important; color:white !important;}
.swal-cancel-blue {background-color:#3498db !important; color:white !important;}
</style>
</head>
<body>
<div style="position:absolute; top:20px; right:20px; text-align:center;">
  <!-- Hidden file input for image change -->
  <input type="file" id="logoutFile" accept="image/*" style="display:none">

  <!-- Logout Image -->
  <img id="logoutImg" src="{{ url_for('static', filename='image3/photo.png') }}" alt="Logout" 
       style="width:40px; height:40px; cursor:pointer; border-radius:50%;">
</div>



<!-- Image Modal -->
<div id="imgModal" onclick="toggleModal()">
  <img id="modalImg" src="" alt="Preview Image">
</div>

<!-- Toast -->
<div class="toast" id="toast">
  <div class="checkmark"></div>
  <p>Phone number copied!</p>
</div>

<!-- Page Toggle -->
<div style="display:flex; gap:15px; margin-bottom:15px;">
<button class="page-btn" onclick="showPage('accountPage')">üë• ACCOUNT USER</button>
<button class="page-btn" onclick="showPage('userPage')">üë§ USER LIST</button>
</div>


<!-- ACCOUNT USER PAGE -->
<div id="accountPage" style="display:none; text-align: center;">

  <!-- ·ÄÅ·Ä±·Ä´·ÄÑ·Ä∫·Ä∏·ÄÖ·Äâ·Ä∫ -->
  <h2 style="margin: 20px 0;">WELCOME</h2>

  <!-- ·Äï·ÄØ·Ä∂ -->
<img src="{{ url_for('static', filename='image1/photo.png') }}" alt="photo Image">
<img src="{{ url_for('static', filename='image2/photo.png') }}" alt="photo Image">




  <!-- ·Äï·ÄØ·Ä∂·Ä°·Ä±·Ä¨·ÄÄ·Ä∫·ÄÖ·Ä¨ -->
  <p style="font-size: 16px; color: #333;">·ÄÖ·Ä¨·Äñ·Äº·Ää·Ä∑·Ä∫·Äõ·Äî·Ä∫·ÄÖ·ÄÆ·ÄÖ·Äâ·Ä∫·Äë·Ä¨·Ä∏·Äû·Ä±·Ä¨·Äî·Ä±·Äõ·Ä¨</p>


</div>





<!-- USER LIST PAGE -->
<div id="userPage">
  <!-- Input Form -->
  <table>
    <thead>
      <tr>
        <th>No.</th><th>Name</th><th>Phone Number</th><th>Date</th><th>Photo</th><th>Platfrom</th><th>Status</th><th>Reason</th><th>Action</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>-</td>
        <td><input type="text" id="name" placeholder="Full Name"></td>
        <td><input type="text" id="phone" placeholder="Phone Number"></td>
        <td><input type="text" id="birthday" placeholder="DD-MM-YY"></td>
        <td><input type="file" id="nrc" accept="image/*"></td>
        <td><input type="text" id="gn" placeholder="Platfrom"></td>
        <td><input type="text" id="reason" placeholder="Status"></td>
        <td><input type="text" id="status" placeholder="Reason"></td>
        <td><button onclick="addRow()">‚úî ADD</button></td>
      </tr>
    </tbody>
  </table>

<div style="display:flex; align-items:center; gap:10px; margin-bottom:10px;">
    <button id="shutdownToggle" onclick="toggleShutdown()">Shut down List</button>
    <input type="text" id="searchInput" class="search-input" placeholder="Search Name/Phone">
    <button onclick="searchTable()">Search</button>
    <button id="exportBtn" onclick="exportData()">Export</button>
</div>

  <!-- Main Data Table -->
  <table id="dataTable">
    <thead>
      <tr>
        <th>No.</th><th>Name</th><th>Phone Number</th><th>Date</th><th>Photo</th><th>Platfrom</th><th>Status</th><th>Reason</th><th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <!-- Shutdown Table -->
  <table id="shutdownTable" style="display:none;">
    <thead>
      <tr>
        <th>No.</th><th>Name</th><th>Phone Number</th><th>Date</th><th>Photo</th><th>Platfrom</th><th>Status</th><th>Reason</th><th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<script>
  // Buttons click animation
  const buttons = document.querySelectorAll("button");
  buttons.forEach(btn => {
    btn.addEventListener("click", () => {
      btn.style.transform = "scale(0.8)";
      setTimeout(() => { btn.style.transform = "scale(1)"; }, 50);
    });
  });

</script>
</body>
</html>
  <script src="your-local-script.js"></script>
  
  <!-- Firebase module -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
    import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "...",
      authDomain: "...",
      databaseURL: "...",
      projectId: "...",
      storageBucket: "...",
      messagingSenderId: "...",
      appId: "..."
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // Save data to Firebase
    function saveDataToFirebase() {
      const main = getTableData("dataTable");
      const shutdown = getTableData("shutdownTable");
      set(ref(db, 'users'), { main, shutdown });
    }

    // Listen for Firebase changes
    onValue(ref(db, 'users/'), (snapshot) => {
      const data = snapshot.val();
      if (!data) return;
      document.querySelector("#dataTable tbody").innerHTML = "";
      document.querySelector("#shutdownTable tbody").innerHTML = "";
      (data.main || []).forEach(d => insertRow(d, "dataTable"));
      (data.shutdown || []).forEach(d => insertRow(d, "shutdownTable", true));
      renumber();
    });

    // Optional: expose globally if you want to call from HTML
    window.saveDataToFirebase = saveDataToFirebase;
  </script>
</body>
</script>

<script
// ‚úÖ correct
src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script> <script>
const STORAGE_KEY="enterpriseFormSystem_v11";
const ACCOUNT_KEY="accountUser_v3";
const PAGE_KEY="currentPage_v2";


// ------------------- PAGE STATE -------------------
function showPage(page){
  localStorage.setItem(PAGE_KEY,page);
  document.getElementById('userPage').style.display = (page==='userPage') ? 'block' : 'none';
  document.getElementById('accountPage').style.display = (page==='accountPage') ? 'block' : 'none';
}

// ------------------- MODAL & TOAST -------------------
function toggleModal(){ document.getElementById("imgModal").style.display=(document.getElementById("imgModal").style.display==="flex")?"none":"flex"; }
function previewImage(src){ document.getElementById("modalImg").src=src; document.getElementById("imgModal").style.display="flex"; }
function showToast(){ const t=document.getElementById("toast"); t.style.display="block"; setTimeout(()=>{t.style.display="none";},1500); }

// ------------------- USER LIST -------------------
function saveData(){ const main=getTableData("dataTable"); const shutdown=getTableData("shutdownTable"); localStorage.setItem(STORAGE_KEY, JSON.stringify({main, shutdown})); }
function loadData(){ const str=localStorage.getItem(STORAGE_KEY); if(!str) return; const data=JSON.parse(str); document.querySelector("#dataTable tbody").innerHTML=""; document.querySelector("#shutdownTable tbody").innerHTML=""; data.main.forEach(d=>insertRow(d,"dataTable")); data.shutdown.forEach(d=>insertRow(d,"shutdownTable",true)); renumber(); }
function getTableData(id){ return Array.from(document.getElementById(id).querySelector("tbody").rows).map(r=>({
  name:r.cells[1].querySelector('input')?.value||"",
  phone:r.cells[2].querySelector('input')?.value||"",
  birthday:r.cells[3].querySelector('input')?.value||"",
  nrc:r.cells[4].querySelector("img")?.src||"",
  gn:r.cells[5].querySelector('input')?.value||"",
  reason:r.cells[6].querySelector('input')?.value||"",
  status:r.cells[7].querySelector('input')?.value||""
})); }
function addRow(){ const name=document.getElementById("name").value.trim(); if(!name){ Swal.fire('Error','Name is required','error'); return; } const file=document.getElementById("nrc").files[0]; if(file){ compressImage(file,500,500,(dataUrl)=>insertFormRow(dataUrl)); } else insertFormRow(""); }
function insertFormRow(dataUrl){ const data={ name:document.getElementById("name").value, phone:document.getElementById("phone").value, birthday:document.getElementById("birthday").value, nrc:dataUrl, gn:document.getElementById("gn").value, reason:document.getElementById("reason").value, status:document.getElementById("status").value }; insertRow(data,"dataTable"); saveData(); clearForm(); renumber(); }
function clearForm(){ ["name","phone","birthday","gn","reason","status"].forEach(id=>document.getElementById(id).value=""); document.getElementById("nrc").value=null; }
function insertRow(data,tableId,isShutdown=false){
  const tbody=document.getElementById(tableId).querySelector("tbody");
  const row=tbody.insertRow();
  row.insertCell(0).innerHTML="-";
  row.insertCell(1).innerHTML=`<input type="text" value="${data.name}" readonly style="border:none;background:transparent;width:100%">`;
  row.insertCell(2).innerHTML=`<input type="text" value="${data.phone}" readonly style="border:none;background:transparent;width:100%"><button class="copy-btn" onclick="copyPhone(this)">Copy</button>`;
  row.insertCell(3).innerHTML=`<input type="text" value="${data.birthday}" readonly style="border:none;background:transparent;width:100%">`;
  row.insertCell(4).innerHTML=data.nrc?`<img src="${data.nrc}" class="preview" onclick="previewImage('${data.nrc}')"><br><input type="file" onchange="updateNRC(this)">`:"<input type='file' onchange='updateNRC(this)'>";
  row.insertCell(5).innerHTML=`<input type="text" value="${data.gn}" readonly style="border:none;background:transparent;width:100%">`;
  row.insertCell(6).innerHTML=`<input type="text" value="${data.reason}" readonly style="border:none;background:transparent;width:100%">`;
  row.insertCell(7).innerHTML=`<input type="text" value="${data.status}" readonly style="border:none;background:transparent;width:100%">`;
  const act=row.insertCell(8);
  if(!isShutdown) act.innerHTML=`<button onclick="editUserRow(this)">‚úè Edit</button>
    <button class="disable-btn" onclick="disableRow(this)">üö´Disable</button>
    <button class="delete-btn" onclick="deleteRow(this)">üóë Delete</button>`;
  else act.innerHTML=`<button class="turnon-btn" onclick="turnOnRow(this)">üîÑTurnOn</button>`;
const btn = document.createElement('button');
}


function copyPhone(btn){
  const row = btn.closest('tr');
  const input = row.cells[2].querySelector('input');
  if(!input) return alert("No phone number found!");

  if(navigator.clipboard && window.isSecureContext){
    navigator.clipboard.writeText(input.value)
      .then(() => showToast())
      .catch(() => fallbackCopy(input.value));
  } else {
    fallbackCopy(input.value);
  }
}
function fallbackCopy(text){
  const textarea = document.createElement("textarea");
  textarea.value = text;
  document.body.appendChild(textarea);
  textarea.select();
  try {
    document.execCommand("copy");
    showToast();
  } catch(e){
    alert("Copy failed: "+e);
  }
  document.body.removeChild(textarea);
}
function showToast(){
  const t=document.getElementById("toast");
  t.style.display="block";
  setTimeout(()=>{ t.style.display="none"; },1500);
}

function fallbackCopy(text){
  const textarea = document.createElement("textarea");
  textarea.value = text;
  document.body.appendChild(textarea);
  textarea.select();
  try {
    document.execCommand("copy");
    showToast();
  } catch(e){
    alert("Copy failed: " + e);
  }
  document.body.removeChild(textarea);
}

// Edit user row
function editUserRow(btn){
  const row = btn.closest('tr');
  for(let i=1; i<row.cells.length-1; i++){
    if(i !== 4){ // skip photo column
      row.cells[i].innerHTML = `<input type="text" value="${row.cells[i].querySelector('input')?.value||row.cells[i].innerText}">`;
    }
  }
  btn.innerText = "üíæ Save";
  btn.onclick = () => saveUserEdit(btn);
}

// Save after edit
function saveUserEdit(btn){
  const row = btn.closest('tr');
  for(let i=1; i<row.cells.length-1; i++){
    if(i !== 4){
      const val = row.cells[i].querySelector('input').value;
      row.cells[i].innerHTML = `<input type="text" value="${val}" readonly style="border:none;background:transparent;width:100%">`;
    }
  }
  btn.innerText = "‚úè Edit";
  btn.onclick = () => editUserRow(btn);
  saveData();
}

// Update NRC image
function updateNRC(input){
  if(input.files[0]){
    compressImage(input.files[0],500,500,(dataUrl)=>{
      input.parentNode.querySelector("img")?.remove();
      const img = document.createElement("img");
      img.src = dataUrl;
      img.className = "preview";
      img.onclick = () => previewImage(dataUrl);
      input.parentNode.appendChild(img);
      saveData();
    });
  }
}

// Disable / shutdown row
function disableRow(btn){
  const row = btn.closest('tr');
  const data = getRowData(row);
  row.remove();
  insertRow(data,"shutdownTable",true);
  renumber();
  saveData();
}

// Re-enable row
function turnOnRow(btn){
  const row = btn.closest('tr');
  const data = getRowData(row);
  row.remove();
  insertRow(data,"dataTable");
  renumber();
  saveData();
}

// Extract row data
function getRowData(row){
  return {
    name: row.cells[1].querySelector('input')?.value||"",
    phone: row.cells[2].querySelector('input')?.value||"",
    birthday: row.cells[3].querySelector('input')?.value||"",
    nrc: row.cells[4].querySelector("img")?.src||"",
    gn: row.cells[5].querySelector('input')?.value||"",
    reason: row.cells[6].querySelector('input')?.value||"",
    status: row.cells[7].querySelector('input')?.value||""
  };
}

// DELETE WITH SWEETALERT2
function deleteRow(btn){
  const row=btn.parentNode.parentNode;
  Swal.fire({
    title: '‚ö†Ô∏è ·Äû·Äê·Ä≠·Äï·Ä±·Ä∏·ÄÅ·Äª·ÄÄ·Ä∫!',
    text: '·Äô·ÄÑ·Ä∫·Ä∏·Äû·Ä∞·Ä∑·ÄÄ·Ä≠·ÄØ·Äê·ÄÄ·Äö·Ä∫·ÄÖ·ÄΩ·Äî·Ä∑·Ä∫·Äú·ÄΩ·Äæ·Äê·Ä∫·Äî·Ä≠·ÄØ·ÄÑ·Ä∫·Äï·Äº·ÄÆ·Äú·Ä¨·Ä∏·Åã ·Äû·Ä±·ÄÅ·Äª·Ä¨·Äú·Ä¨·Ä∏?',
    icon: 'warning',
    showCancelButton: true,
    confirmButtonText: '·Äû·Ä±·ÄÅ·Äª·Ä¨·Äê·Äö·Ä∫',
    cancelButtonText: '·ÄÅ·Äª·ÄÖ·Ä∫·Äî·Ä±·Äû·Ä±·Ä∏·Äê·Äö·Ä∫',
    reverseButtons: true,
    customClass: {
      confirmButton: 'swal-confirm-red',
      cancelButton: 'swal-cancel-blue'
    }
  }).then((result)=>{
    if(result.isConfirmed){
      row.remove();
      renumber();
      saveData();
      Swal.fire('·Äô·ÄÑ·Ä∫·Ä∏·ÄÜ·ÄØ·Ä∂·Ä∏·Äõ·Äæ·ÄØ·Ä∂·Ä∏·Äú·Ä≠·ÄØ·ÄÄ·Ä∫·Äõ·Äï·Äº·ÄÆ!', '·Äï·Äº·Äî·Ä∫·Äú·Ä≠·ÄØ·ÄÅ·Äª·ÄÑ·Ä∫·Äú·Ää·Ä∫·Ä∏·Äô·Äõ·Äê·Ä±·Ä¨·Ä∑·Äò·Ä∞·Ä∏·Åã', 'success');
    }
  });
}


function renumber(){ ["dataTable","shutdownTable"].forEach(id=>Array.from(document.getElementById(id).querySelectorAll("tbody tr")).forEach((r,i)=>r.cells[0].innerText=i+1)); }
function toggleShutdown(){ const t=document.getElementById("shutdownTable"); t.style.display=(t.style.display==="none")?"table":"none"; document.getElementById("dataTable").style.display=(t.style.display==="none")?"table":"none"; }
function searchTable(){ const filter=document.getElementById("searchInput").value.toLowerCase(); ["dataTable","shutdownTable"].forEach(id=>Array.from(document.getElementById(id).querySelectorAll("tbody tr")).forEach(row=>{ const tdName=row.cells[1].querySelector('input')?.value.toLowerCase()||""; const tdPhone=row.cells[2].querySelector('input')?.value.toLowerCase()||""; row.style.display=(tdName.includes(filter)||tdPhone.includes(filter))?"":"none"; })); }
function compressImage(file,maxW,maxH,cb){ const reader=new FileReader(); reader.onload=e=>{ const img=new Image(); img.onload=()=>{ let w=img.width,h=img.height; if(w>h && w>maxW){h*=maxW/w; w=maxW;} else if(h>=w && h>maxH){w*=maxH/h; h=maxH;} const canvas=document.createElement('canvas'); canvas.width=w; canvas.height=h; canvas.getContext('2d').drawImage(img,0,0,w,h); let q=0.6; let dataUrl=canvas.toDataURL("image/jpeg",q); while(dataUrl.length/1024>1024 && q>0.1){ q-=0.05; dataUrl=canvas.toDataURL("image/jpeg",q);} cb(dataUrl); }; img.src=e.target.result; }; reader.readAsDataURL(file); }

window.onload = () => {
  loadData();
  showPage(localStorage.getItem(PAGE_KEY) || "accountPage");
};
</script>
</body>
</html>



